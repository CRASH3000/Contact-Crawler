

## О проекте

---
<img src="docs/The.png" alt="Скрин Swagger" width="350">

Contact Crawler - это учебный проект, представляющего из себя 
многопоточное веб-приложение на **Spring Boot**, который 
ищет данные об организации используя URL-адреса сайтов компаний.

**Функционал:**

* Многопоточный краулер получает список URL с контактами компаний.
* Через `WebClient` тянет HTML и с помощью регулярок извлекает:
    * номер телефоны (российский формат `+7` / `8` и 10 цифр);
    * email.
* Результат сохраняет в **H2 in-memory БД** в таблицу `contact_info`.
* Через REST-API можно:
    * запустить краулер вручную;
    * посмотреть все найденные контакты с сортировкой и пагинацией;
    * искать по названию/домену.

Так же имеется автозаполнение БД тремя тестовыми контактами 
при старте и плановый запуск краулера по расписанию.

⚠️ **Ограничения:**

* Краулер видит только **сырой HTML**.
  Если сайт рисует телефоны через JavaScript/AJAX, то сервис их не найдет.
* Телефоны хранятся **одной строкой**, несколько номеров склеиваются через запятую.
* Лимит обхода не больше **20 страниц за запуск**.
* БД H2 в памяти. После перезапуска данные найденные краулером пропадают.

## Как запустить проект?

---

### Что нужно:
>* **JDK 17+**
>* Свободный порт **8080**
>* Доступ в интернет

Все зависимости и Gradle уже в проекте (`gradlew`), отдельно ничего ставить не нужно.

### Запуск приложения

В корне проекта:

```bash
./gradlew bootRun        # macOS / Linux
gradlew.bat bootRun      # Windows
```

Приложение поднимется на:
`http://localhost:8080`

Для завершения приложения необходимо нажать Ctrl + C в том же окне терминала. 

### Проверка логики через Swagger

Swagger UI:
`http://localhost:8080/swagger-ui/index.html`

Дальше последовательность для проверки:

1. **Проверить, что есть стартовые данные**

    * Открыть блок **«Работа с контактами»**
    * Вызвать `GET /api/contacts/answer` → **Try it out → Execute**
    * В ответе должны быть тестовых контакта.


2. **Запустить краулер вручную**

    * Открыть блок **«Запуск краулера»**

    * `POST /api/crawler/start` → **Try it out**

    * В тело запроса вставить, например:

      ```json
      {
        "startUrls": [
          "https://netology.ru/contacts",
          "https://moskva.beeline.ru/customers/contact-page"
        ]
      }
      ```

    * Нажать **Execute**.
      В ответе придёт массив строк со статусами по каждому URL (`OK / WARN / ERROR`).


3. **Посмотреть новые контакты**

    * Снова вызвать `GET /api/contacts/answer`.
    * В конце списка должны появиться новые записи с телефонами/email, если на страницах они были в HTML.


4. **Проверить поиск**

    * `GET /api/contacts/search`
    * Пример: `query=netology` или `query=beeline` → **Execute**
    * В ответе остаются только подходящие контакты.

### Запуск юнит-тестов

```bash
./gradlew clean test        # macOS / Linux
gradlew.bat clean test      # Windows
```

